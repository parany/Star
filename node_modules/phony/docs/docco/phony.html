<!DOCTYPE html>  <html> <head>   <title>phony.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="phony-cli.html">                 phony-cli.coffee               </a>                                           <a class="source" href="phony-data.html">                 phony-data.coffee               </a>                                           <a class="source" href="phony.html">                 phony.coffee               </a>                                           <a class="source" href="test-phony.html">                 test-phony.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               phony.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <hr />             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">HOMEDIR         = </span><span class="nx">__dirname</span> <span class="o">+</span> <span class="s">&quot;/..&quot;</span>
<span class="nv">IS_COFFEE       = </span><span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="s">&quot;coffee&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span>
<span class="nv">IS_INSTRUMENTED = </span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;path&#39;</span><span class="p">)).</span><span class="nx">existsSync</span><span class="p">(</span><span class="nx">HOMEDIR</span><span class="o">+</span><span class="s">&#39;/lib-cov&#39;</span><span class="p">)</span>
<span class="nv">LIB_DIR         = </span><span class="k">if</span> <span class="nx">IS_INSTRUMENTED</span> <span class="k">then</span> <span class="nx">HOMEDIR</span><span class="o">+</span><span class="s">&quot;/lib-cov&quot;</span> <span class="k">else</span> <span class="nx">HOMEDIR</span><span class="o">+</span><span class="s">&quot;/lib&quot;</span>
<span class="nv">FILE_SUFFIX     = </span><span class="k">if</span> <span class="nx">IS_COFFEE</span> <span class="k">then</span> <span class="s">&quot;.coffee&quot;</span> <span class="k">else</span> <span class="s">&quot;.js&quot;</span>
<span class="nv">PHONY_DATA      = </span><span class="nx">LIB_DIR</span> <span class="o">+</span> <span class="s">&quot;/phony-data&quot;</span>  <span class="o">+</span> <span class="nx">FILE_SUFFIX</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <hr />             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">Phony</span>
  <span class="nx">constructor</span><span class="o">:</span><span class="nf">()-&gt;</span>

  <span class="nv">data: </span><span class="nx">require</span><span class="p">(</span><span class="nx">PHONY_DATA</span><span class="p">).</span><span class="nx">data</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>returns a random element of the array <code>a</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">re</span><span class="o">:</span><span class="nf">(a)-&gt;</span><span class="nx">a</span><span class="p">[</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="nx">a</span><span class="p">.</span><span class="nx">length</span><span class="p">)]</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>returns a random integer <code>n</code> where <code>min</code> &lt;= <code>n</code> &lt; <code>max</code>
<code>min</code> and <code>max</code> are assumed to be integers</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">ri</span><span class="o">:</span><span class="nf">(min,max)-&gt;</span>
    <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">@rf</span><span class="p">(</span><span class="nx">min</span><span class="p">,</span><span class="nx">max</span><span class="p">))</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>returns a random floating-point number <code>f</code> where <code>min</code> &lt;= <code>f</code> &lt; <code>max</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">rf</span><span class="o">:</span><span class="nf">(min,max)-&gt;</span>
    <span class="k">if</span> <span class="o">!</span><span class="nx">max</span><span class="o">?</span>
      <span class="nv">max = </span><span class="nx">min</span>
      <span class="nv">min = </span><span class="mi">0</span>
    <span class="nv">delta = </span><span class="nx">max</span> <span class="o">-</span> <span class="nx">min</span>
    <span class="k">return</span> <span class="nx">min</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="nx">delta</span>

  <span class="nx">rb</span><span class="o">:</span><span class="nf">(t=1,f=1)-&gt;</span><span class="p">(</span><span class="nx">@ri</span><span class="p">(</span><span class="nx">t</span><span class="o">+</span><span class="nx">f</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nx">t</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>roulette selection
Given an array <code>a</code> of frequencies (weights),</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">rs</span><span class="o">:</span><span class="nf">(a,b)-&gt;</span>
    <span class="nv">sum = </span><span class="mi">0</span>
    <span class="k">for</span> <span class="nx">e</span> <span class="k">in</span> <span class="nx">a</span>
      <span class="nx">sum</span> <span class="o">+=</span> <span class="nx">e</span>
    <span class="nv">val = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="o">*</span><span class="nx">sum</span>
    <span class="k">for</span> <span class="nx">e</span><span class="p">,</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">a</span>
      <span class="nx">val</span> <span class="o">-=</span> <span class="nx">e</span>
      <span class="k">if</span> <span class="nx">val</span> <span class="o">&lt;=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="nx">b</span><span class="o">?</span>
          <span class="k">return</span> <span class="nx">b</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span>
        <span class="k">else</span>
          <span class="k">return</span> <span class="nx">i</span>
    <span class="k">throw</span> <span class="s">&quot;Should never get here&quot;</span>

  <span class="nv">options: </span><span class="p">{</span>
    <span class="nv">min_street_number: </span><span class="mi">10</span><span class="p">,</span>
    <span class="nv">max_street_number: </span><span class="mi">9999</span><span class="p">,</span>
    <span class="nv">street_name_prefix_frequency: </span><span class="mf">0.75</span><span class="p">,</span>
    <span class="nv">min_sentences_per_paragraph: </span><span class="mi">3</span><span class="p">,</span>
    <span class="nv">max_sentences_per_paragraph: </span><span class="mi">6</span>
    <span class="nv">male_female_ratio: </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
  <span class="p">}</span>

  <span class="nx">surname</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span><span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">NAMES_US_SURNAME</span><span class="p">)</span>
  <span class="nx">male_first_name</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span><span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">NAMES_US_MALE</span><span class="p">)</span>
  <span class="nx">male_name</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span>
    <span class="k">return</span> <span class="k">switch</span> <span class="nx">opts</span><span class="p">[</span><span class="s">&#39;return&#39;</span><span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;array&#39;</span>        <span class="k">then</span> <span class="p">[</span> <span class="nx">@male_first_name</span><span class="p">(),</span> <span class="nx">@surname</span><span class="p">()</span> <span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;map&#39;</span><span class="p">,</span><span class="s">&#39;object&#39;</span> <span class="k">then</span> <span class="p">{</span> <span class="nx">first_name</span><span class="o">:</span><span class="nx">@male_first_name</span><span class="p">(),</span> <span class="nx">surname</span><span class="o">:</span><span class="nx">@surname</span><span class="p">()</span> <span class="p">}</span>
      <span class="k">else</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@male_first_name</span><span class="p">()</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">@surname</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
  <span class="nx">female_first_name</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span><span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">NAMES_US_FEMALE</span><span class="p">)</span>
  <span class="nx">female_name</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span>
    <span class="k">return</span> <span class="k">switch</span> <span class="nx">opts</span><span class="p">[</span><span class="s">&#39;return&#39;</span><span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;array&#39;</span>        <span class="k">then</span> <span class="p">[</span> <span class="nx">@female_first_name</span><span class="p">(),</span> <span class="nx">@surname</span><span class="p">()</span> <span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;map&#39;</span><span class="p">,</span><span class="s">&#39;object&#39;</span> <span class="k">then</span> <span class="p">{</span> <span class="nx">first_name</span><span class="o">:</span><span class="nx">@female_first_name</span><span class="p">(),</span> <span class="nx">surname</span><span class="o">:</span><span class="nx">@surname</span><span class="p">()</span> <span class="p">}</span>
      <span class="k">else</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@female_first_name</span><span class="p">()</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">@surname</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
  <span class="nx">first_name</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span>
    <span class="k">if</span> <span class="nx">@rs</span><span class="p">(</span><span class="nx">@options</span><span class="p">.</span><span class="nx">male_female_ratio</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
      <span class="k">return</span> <span class="nx">@male_first_name</span><span class="p">()</span>
    <span class="k">else</span>
      <span class="k">return</span> <span class="nx">@female_first_name</span><span class="p">()</span>
  <span class="nx">name</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span>
    <span class="k">return</span> <span class="k">switch</span> <span class="nx">opts</span><span class="p">[</span><span class="s">&#39;return&#39;</span><span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;array&#39;</span>        <span class="k">then</span> <span class="p">[</span> <span class="nx">@first_name</span><span class="p">(),</span> <span class="nx">@surname</span><span class="p">()</span> <span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;map&#39;</span><span class="p">,</span><span class="s">&#39;object&#39;</span> <span class="k">then</span> <span class="p">{</span> <span class="nx">first_name</span><span class="o">:</span><span class="nx">@first_name</span><span class="p">(),</span> <span class="nx">surname</span><span class="o">:</span><span class="nx">@surname</span><span class="p">()</span> <span class="p">}</span>
      <span class="k">else</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@first_name</span><span class="p">()</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">@surname</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>

  <span class="nx">street</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span>
    <span class="nv">str = </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">STREET_NAMES</span><span class="p">)</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">STREET_NAME_SUFFIX</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="k">if</span> <span class="nx">@rs</span><span class="p">([</span><span class="nx">@options</span><span class="p">.</span><span class="nx">street_name_prefix_frequency</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="nx">@options</span><span class="p">.</span><span class="nx">street_name_prefix_frequency</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span>
      <span class="nv">str = </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">STREET_NAME_PREFIXES</span><span class="p">)</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">str</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="k">return</span> <span class="nx">str</span>

  <span class="nx">street_address</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">@ri</span><span class="p">(</span><span class="nx">@options</span><span class="p">.</span><span class="nx">min_street_number</span><span class="p">,</span><span class="nx">@options</span><span class="p">.</span><span class="nx">max_street_number</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">@street</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>

  <span class="nx">city</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span>
    <span class="k">if</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">state</span><span class="o">?</span>
      <span class="k">return</span> <span class="nx">@re</span><span class="p">(</span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">GEO</span><span class="p">.</span><span class="nx">US</span><span class="p">[</span><span class="nx">opts</span><span class="p">.</span><span class="nx">state</span><span class="p">]))</span>
    <span class="k">else</span>
      <span class="k">return</span> <span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">CITIES</span><span class="p">)</span>

  <span class="nx">state</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span><span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">STATES</span><span class="p">)</span>
  <span class="nx">postal_code</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span>
    <span class="k">if</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">state</span><span class="o">?</span> <span class="o">&amp;&amp;</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">city</span><span class="o">?</span>
      <span class="k">return</span> <span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">GEO</span><span class="p">.</span><span class="nx">US</span><span class="p">[</span><span class="nx">opts</span><span class="p">.</span><span class="nx">state</span><span class="p">][</span><span class="nx">opts</span><span class="p">.</span><span class="nx">city</span><span class="p">])</span>
    <span class="k">else</span>
      <span class="k">return</span> <span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">POSTAL_CODES</span><span class="p">)</span>
  <span class="nx">zip_code</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span><span class="o">=&gt;</span><span class="k">return</span> <span class="nx">@postal_code</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span>

  <span class="nx">city_state</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span>
    <span class="nv">state = </span><span class="nx">@state</span><span class="p">()</span>
    <span class="nv">city = </span><span class="nx">@city</span><span class="p">(</span><span class="nx">state</span><span class="o">:</span><span class="nx">state</span><span class="p">)</span>
    <span class="k">return</span> <span class="k">switch</span> <span class="nx">opts</span><span class="p">[</span><span class="s">&#39;return&#39;</span><span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;array&#39;</span>        <span class="k">then</span> <span class="p">[</span> <span class="nx">city</span><span class="p">,</span> <span class="nx">state</span> <span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;map&#39;</span><span class="p">,</span><span class="s">&#39;object&#39;</span> <span class="k">then</span> <span class="p">{</span> <span class="nx">city</span><span class="o">:</span><span class="nx">city</span><span class="p">,</span> <span class="nx">state</span><span class="o">:</span><span class="nx">state</span> <span class="p">}</span>
      <span class="k">else</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">city</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">state</span><span class="si">}</span><span class="s">&quot;</span>

  <span class="nx">city_state_zip</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span>
    <span class="nv">state = </span><span class="nx">@state</span><span class="p">()</span>
    <span class="nv">city = </span><span class="nx">@city</span><span class="p">(</span><span class="nx">state</span><span class="o">:</span><span class="nx">state</span><span class="p">)</span>
    <span class="nv">zip = </span><span class="nx">@postal_code</span><span class="p">(</span><span class="nx">state</span><span class="o">:</span><span class="nx">state</span><span class="p">,</span><span class="nx">city</span><span class="o">:</span><span class="nx">city</span><span class="p">)</span>
    <span class="k">return</span> <span class="k">switch</span> <span class="nx">opts</span><span class="p">[</span><span class="s">&#39;return&#39;</span><span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;array&#39;</span>        <span class="k">then</span> <span class="p">[</span> <span class="nx">city</span><span class="p">,</span> <span class="nx">state</span><span class="p">,</span> <span class="nx">zip</span> <span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;map&#39;</span><span class="p">,</span><span class="s">&#39;object&#39;</span> <span class="k">then</span> <span class="p">{</span> <span class="nx">city</span><span class="o">:</span><span class="nx">city</span><span class="p">,</span> <span class="nx">state</span><span class="o">:</span><span class="nx">state</span><span class="p">,</span> <span class="nx">postal_code</span><span class="o">:</span><span class="nx">zip</span> <span class="p">}</span>
      <span class="k">else</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">city</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">state</span><span class="si">}</span><span class="s"> </span><span class="si">#{</span><span class="nx">zip</span><span class="si">}</span><span class="s">&quot;</span>

  <span class="nx">letter</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span><span class="nx">@letters</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="nx">letters</span><span class="o">:</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span>
    <span class="nv">delim = </span><span class="k">if</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">delimiter</span><span class="o">?</span> <span class="k">then</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">delimiter</span> <span class="k">else</span> <span class="s">&#39;&#39;</span>
    <span class="nv">letters = </span><span class="p">[]</span>
    <span class="k">while</span> <span class="nx">n</span> <span class="o">&gt;</span> <span class="mi">0</span>
      <span class="nx">letters</span><span class="p">.</span><span class="nx">push</span> <span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">LETTERS</span><span class="p">)</span>
      <span class="nx">n</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="k">switch</span> <span class="nx">opts</span><span class="p">[</span><span class="s">&#39;return&#39;</span><span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;array&#39;</span> <span class="k">then</span> <span class="nx">letters</span>
      <span class="k">else</span> <span class="nx">letters</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">delim</span><span class="p">)</span>

  <span class="nx">word</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span><span class="o">=&gt;</span><span class="nx">@words</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nx">opts</span><span class="p">)</span>
  <span class="nx">words</span><span class="o">:</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span>
    <span class="nv">words = </span><span class="p">[]</span>
    <span class="k">while</span> <span class="nx">n</span><span class="o">&gt;</span><span class="mi">0</span>
      <span class="nx">words</span><span class="p">.</span><span class="nx">push</span> <span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">MANY_WORDS</span><span class="p">)</span>
      <span class="nx">n</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="k">switch</span> <span class="nx">opts</span><span class="p">[</span><span class="s">&#39;return&#39;</span><span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;array&#39;</span> <span class="k">then</span> <span class="nx">words</span>
      <span class="k">else</span> <span class="nx">words</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>TODO allow caller to specify word sources, e.g., <code>words()</code>, <code>words(source:"lorem")</code>, <code>words(source:"english")</code>, etc.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">lorem_word</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span><span class="o">=&gt;</span><span class="nx">@lorem_words</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nx">opts</span><span class="p">)</span>
  <span class="nx">lorem_words</span><span class="o">:</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span>
    <span class="nv">words = </span><span class="p">[]</span>
    <span class="k">while</span> <span class="nx">n</span><span class="o">&gt;</span><span class="mi">0</span>
      <span class="nx">words</span><span class="p">.</span><span class="nx">push</span> <span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">LOREM_WORDS</span><span class="p">)</span>
      <span class="nx">n</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="k">switch</span> <span class="nx">opts</span><span class="p">[</span><span class="s">&#39;return&#39;</span><span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;array&#39;</span> <span class="k">then</span> <span class="nx">words</span>
      <span class="k">else</span> <span class="nx">words</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>

  <span class="nx">lorem_sentence</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span><span class="o">=&gt;</span><span class="nx">@lorem_sentences</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nx">opts</span><span class="p">)</span>
  <span class="nx">lorem_sentences</span><span class="o">:</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span>
    <span class="nv">sentences = </span><span class="p">[]</span>
    <span class="k">while</span> <span class="nx">n</span><span class="o">&gt;</span><span class="mi">0</span>
      <span class="nx">sentences</span><span class="p">.</span><span class="nx">push</span> <span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">LOREM_LINES</span><span class="p">)</span>
      <span class="nx">n</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="k">switch</span> <span class="nx">opts</span><span class="p">[</span><span class="s">&#39;return&#39;</span><span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;array&#39;</span> <span class="k">then</span> <span class="nx">sentences</span>
      <span class="k">else</span> <span class="nx">sentences</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>

  <span class="nx">lorem_paragraph</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="p">)</span><span class="o">=&gt;</span><span class="nx">@lorem_paragraphs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nx">opts</span><span class="p">)</span>
  <span class="nx">lorem_paragraphs</span><span class="o">:</span><span class="p">(</span><span class="nx">n</span><span class="p">,</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span>
    <span class="nv">paragraphs = </span><span class="p">[]</span>
    <span class="k">while</span> <span class="nx">n</span><span class="o">&gt;</span><span class="mi">0</span>
      <span class="nx">paragraphs</span><span class="p">.</span><span class="nx">push</span> <span class="nx">@lorem_sentences</span><span class="p">(</span><span class="nx">@ri</span><span class="p">(</span><span class="nx">@options</span><span class="p">.</span><span class="nx">min_sentences_per_paragraph</span><span class="p">,</span><span class="nx">@options</span><span class="p">.</span><span class="nx">min_sentences_per_paragraph</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
      <span class="nx">n</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="k">switch</span> <span class="nx">opts</span><span class="p">[</span><span class="s">&#39;return&#39;</span><span class="p">]</span>
      <span class="k">when</span> <span class="s">&#39;array&#39;</span> <span class="k">then</span> <span class="nx">paragraphs</span>
      <span class="k">else</span> <span class="nx">paragraphs</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">)</span>

  <span class="nx">title</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span> <span class="nx">@_title_case</span><span class="p">(</span><span class="nx">@words</span><span class="p">(</span><span class="nx">@ri</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="nx">@ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
  <span class="nx">lorem_title</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span> <span class="nx">@_title_case</span><span class="p">(</span><span class="nx">@lorem_words</span><span class="p">(</span><span class="nx">@ri</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="nx">@ri</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>

  <span class="nx">_title_case</span><span class="o">:</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span><span class="o">=&gt;</span> <span class="c1"># TODO make title case a little smarter, e.g., down upcase short words in the middle of the title.</span>
    <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span> <span class="sr">/\w\S*/g</span><span class="p">,</span> <span class="nf">(txt)-&gt;</span>
      <span class="nx">txt</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">+</span> <span class="nx">txt</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">()</span>

  <span class="nx">domain_name</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span>
    <span class="nv">domain = </span><span class="nx">@rs</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">TLD_WEIGHTS</span><span class="p">,</span><span class="nx">@data</span><span class="p">.</span><span class="nx">TLDS</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">@data</span><span class="p">.</span><span class="nx">SLDS</span><span class="p">[</span><span class="nx">domain</span><span class="p">]</span><span class="o">?</span>
      <span class="nv">domain = </span><span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">SLDS</span><span class="p">[</span><span class="nx">domain</span><span class="p">])</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">@rs</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
      <span class="k">return</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@word</span><span class="p">()</span><span class="si">}#{</span><span class="nx">@word</span><span class="p">()</span><span class="si">}</span><span class="s">.</span><span class="si">#{</span><span class="nx">domain</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="k">else</span>
      <span class="k">return</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@word</span><span class="p">()</span><span class="si">}</span><span class="s">.</span><span class="si">#{</span><span class="nx">domain</span><span class="si">}</span><span class="s">&quot;</span>

  <span class="nx">host_name</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span>
    <span class="nv">domain = </span><span class="nx">@domain_name</span><span class="p">()</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">@rs</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
      <span class="k">return</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">WEB_HOSTS</span><span class="p">)</span><span class="si">}</span><span class="s">.</span><span class="si">#{</span><span class="nx">domain</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="k">else</span>
      <span class="k">return</span> <span class="nx">domain</span>

  <span class="nx">_word</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span><span class="k">return</span> <span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">NAMISH_WORDS</span><span class="p">)</span>
  <span class="nx">username</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span>
    <span class="k">switch</span> <span class="nx">@rs</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
      <span class="k">when</span> <span class="mi">0</span> <span class="k">then</span> <span class="nx">@_word</span><span class="p">()</span>
      <span class="k">when</span> <span class="mi">1</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">when</span> <span class="mi">2</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}</span><span class="s">.</span><span class="si">#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">when</span> <span class="mi">3</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}</span><span class="s">-</span><span class="si">#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">when</span> <span class="mi">4</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@letter</span><span class="p">()</span><span class="si">}#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">when</span> <span class="mi">5</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@letter</span><span class="p">()</span><span class="si">}</span><span class="s">.</span><span class="si">#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">when</span> <span class="mi">6</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@letter</span><span class="p">()</span><span class="si">}</span><span class="s">-</span><span class="si">#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">when</span> <span class="mi">7</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@letters</span><span class="p">(</span><span class="nx">@ri</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="si">}#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">when</span> <span class="mi">8</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@letters</span><span class="p">(</span><span class="nx">@ri</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="si">}</span><span class="s">.</span><span class="si">#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">when</span> <span class="mi">9</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@letters</span><span class="p">(</span><span class="nx">@ri</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="si">}</span><span class="s">-</span><span class="si">#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">when</span> <span class="mi">10</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}#{</span><span class="nx">@letters</span><span class="p">(</span><span class="nx">@ri</span><span class="p">(</span><span class="mf">1.3</span><span class="p">))</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">when</span> <span class="mi">11</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}</span><span class="s">.</span><span class="si">#{</span><span class="nx">@letters</span><span class="p">(</span><span class="nx">@ri</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">when</span> <span class="mi">12</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@_word</span><span class="p">()</span><span class="si">}</span><span class="s">-</span><span class="si">#{</span><span class="nx">@letters</span><span class="p">(</span><span class="nx">@ri</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">else</span> <span class="nx">@letters</span><span class="p">(</span><span class="nx">@ri</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span>

  <span class="nx">email_address</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">@username</span><span class="p">()</span><span class="si">}</span><span class="s">@</span><span class="si">#{</span><span class="nx">@domain_name</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>

  <span class="nx">file_path</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span>
    <span class="nv">path = </span><span class="s">&#39;&#39;</span>
    <span class="nv">n = </span><span class="nx">@ri</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">while</span> <span class="nx">n</span> <span class="o">&gt;</span> <span class="mi">0</span>
      <span class="nx">path</span> <span class="o">+=</span> <span class="s">&quot;/</span><span class="si">#{</span><span class="nx">@word</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="nx">n</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="nx">path</span>

  <span class="nx">file_name</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span>
    <span class="k">return</span> <span class="k">switch</span> <span class="nx">@rs</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
      <span class="k">when</span> <span class="mi">0</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@word</span><span class="p">()</span><span class="si">}</span><span class="s">.</span><span class="si">#{</span><span class="nx">@re</span><span class="p">(</span><span class="nx">@data</span><span class="p">.</span><span class="nx">FILE_EXT</span><span class="p">)</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">else</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@word</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>

  <span class="nx">file_path_and_name</span><span class="o">:</span><span class="p">()</span><span class="o">=&gt;</span>
    <span class="k">return</span> <span class="k">switch</span> <span class="nx">@rs</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
      <span class="k">when</span> <span class="mi">0</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@file_path</span><span class="p">()</span><span class="si">}</span><span class="s">/</span><span class="si">#{</span><span class="nx">@file_name</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">when</span> <span class="mi">1</span> <span class="k">then</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@file_path</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
      <span class="k">else</span> <span class="s">&quot;</span><span class="si">#{</span><span class="nx">@file_path</span><span class="p">()</span><span class="si">}</span><span class="s">/&quot;</span>

  <span class="nx">uri</span><span class="o">:</span><span class="p">(</span><span class="nx">opts</span><span class="o">=</span><span class="p">{})</span><span class="o">=&gt;</span>
    <span class="nv">schemes = </span><span class="k">if</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">schemes</span><span class="o">?</span> <span class="k">then</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">schemes</span> <span class="k">else</span> <span class="p">[</span> <span class="s">&#39;http&#39;</span><span class="p">,</span> <span class="s">&#39;http&#39;</span><span class="p">,</span> <span class="s">&#39;http&#39;</span><span class="p">,</span> <span class="s">&#39;http&#39;</span><span class="p">,</span> <span class="s">&#39;http&#39;</span><span class="p">,</span> <span class="s">&#39;https&#39;</span> <span class="p">]</span>
    <span class="nv">ports = </span><span class="k">if</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">ports</span><span class="o">?</span> <span class="k">then</span> <span class="nx">opts</span><span class="p">.</span><span class="nx">ports</span> <span class="k">else</span> <span class="p">[</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">8080</span> <span class="p">]</span>
    <span class="nv">uri = </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">@re</span><span class="p">(</span><span class="nx">schemes</span><span class="p">)</span><span class="si">}</span><span class="s">://</span><span class="si">#{</span><span class="nx">@host_name</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="nv">port = </span><span class="nx">@re</span><span class="p">(</span><span class="nx">ports</span><span class="p">)</span>
    <span class="k">if</span> <span class="nx">port</span><span class="o">?</span>
      <span class="nx">uri</span> <span class="o">+=</span> <span class="s">&quot;:</span><span class="si">#{</span><span class="nx">port</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="nx">uri</span> <span class="o">+=</span> <span class="nx">@rs</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="nx">@file_path_and_name</span><span class="p">(),</span><span class="s">&quot;/</span><span class="si">#{</span><span class="nx">@file_name</span><span class="p">()</span><span class="si">}</span><span class="s">&quot;</span><span class="p">,</span><span class="s">&#39;/&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="nx">uri</span>

<span class="nv">exports.make_phony = </span><span class="nf">()-&gt;</span><span class="k">new</span> <span class="nx">Phony</span><span class="p">()</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 